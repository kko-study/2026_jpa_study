# 9장 과제 – 값 타입

아래 질문들에 대해 각자의 의견을 정리해 주세요.

---

### Q1. 값 타입 컬렉션 vs 일대다 엔티티

주소 이력(`AddressHistory`)을 관리해야 하는 상황입니다.

A안: `@ElementCollection`으로 값 타입 컬렉션 사용<br>
B안: AddressHistory를 별도 엔티티로 만들고 `@OneToMany` 사용

- 각 방식을 선택했을 때, **수정/삭제 시 발생하는 SQL**은 어떻게 달라지나요?
A안 : 수정/삭제 시 값 타입 컬렉션 매핑된 테이블의 연관된 모든 데이터 삭제 후 현재 컬렉션 객체의 모든 값을 다시 저장
B안 : 특정 엔티티만 선택하여 수정/삭제

- 실무에서 어떤 기준으로 선택하실 건가요?
매핑된 데이터가 많지 않은 경우 (조회 시 특정이 힘들어짐)
수정/삭제가 빈번하지 않은 경우 (SQL 횟수로 인한 성능 저하)
추후 발전되어 독립적인 조회가 필요할 것으로 예상될 경우 (다른 필드가 불필요한 값이 되므로)

---

### Q2. 임베디드 타입과 불변 객체

임베디드 타입(`@Embeddable`)은 여러 엔티티에서 공유하면 사이드 이펙트가 발생할 수 있다고 합니다.
이를 방지하기 위해 "불변 객체로 만들어야 한다"고 하는데,

- 불변 객체로 만들면 값을 변경하고 싶을 때는 어떻게 해야 할까요?
변경되지 않는 값만 복사한 신규 객체 재생성

- 본인이 실무에서 Address 같은 임베디드 타입을 설계한다면 어떻게 하실건가요?
불변 객체로 사용(kotlin data class 및 전체 필드 불변, copy 메서드를 통한 복사)
Address 내부 필드가 많아질 경우 1:N 관계로 재설계

---
