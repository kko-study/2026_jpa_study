# 9장 과제 – 값 타입

아래 질문들에 대해 각자의 의견을 정리해 주세요.

---

### Q1. 값 타입 컬렉션 vs 일대다 엔티티

주소 이력(`AddressHistory`)을 관리해야 하는 상황입니다.

A안: `@ElementCollection`으로 값 타입 컬렉션 사용<br>
B안: AddressHistory를 별도 엔티티로 만들고 `@OneToMany` 사용

- 각 방식을 선택했을 때, **수정/삭제 시 발생하는 SQL**은 어떻게 달라지나요?
  > 값 타입 컬렉션을 사용했을때에는 엔티티와는 달리 데이터를 식별할수 없게 때문에 전체 삭제 & 추가 형태로 동작하는걸로 알고 있습니다. 

- 실무에서 어떤 기준으로 선택하실 건가요?
  > 실무에서는 엔티티를 만들어서 사용할것 같아요. 의도하지 않은 갱신 쿼리가 발생할것 같아요. 객체로 만들어서 재사용성 및 응집성을 높이는게 목적이고 대부분은 이런경우에 추척 & 관리가 되어야 한다면 일대다 혹은 다대다에서 엔티티로 만들어서 사용할거 같고 값 타입 컬렉션은 사용하지 않을것 같아요.

---

### Q2. 임베디드 타입과 불변 객체

임베디드 타입(`@Embeddable`)은 여러 엔티티에서 공유하면 사이드 이펙트가 발생할 수 있다고 합니다.
이를 방지하기 위해 "불변 객체로 만들어야 한다"고 하는데,

- 불변 객체로 만들면 값을 변경하고 싶을 때는 어떻게 해야 할까요?
  > setter 를 통해서 객체의 값을 수정하는게 아닌 종속적인 엔티티에 값을 새로 생성해서 변경해야 해요.

- 본인이 실무에서 Address 같은 임베디드 타입을 설계한다면 어떻게 하실건가요?
  > 응집성이 있는 속성들에서는 적극적으로 사용할것 같고, 값타입 컬렉션은 지양해서 사용하고자 해요.

---


## (Optional) 자유 토론 주제
9장을 읽으며 추가로 고민한 점이나 토론하고 싶은 주제가 있다면 자유롭게 작성해주세요.

- 엔티티를 설계할때는 상태만 다루어야 된다고 생각했는데, 임베디드 타입에 대해서 함수를 사용하는것은 영속성 계층이 비지니스 로직을 침범해서 혼동을 줄 여지가 있어 보여서 다른분들은 어떻게 생각하는지 궁금해요.