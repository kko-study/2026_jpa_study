# 9장 과제 – 값 타입

아래 질문들에 대해 각자의 의견을 정리해 주세요.

---

### Q1. 값 타입 컬렉션 vs 일대다 엔티티

주소 이력(`AddressHistory`)을 관리해야 하는 상황입니다.

A안: `@ElementCollection`으로 값 타입 컬렉션 사용<br>
B안: AddressHistory를 별도 엔티티로 만들고 `@OneToMany` 사용

- 각 방식을 선택했을 때, **수정/삭제 시 발생하는 SQL**은 어떻게 달라지나요?
- 실무에서 어떤 기준으로 선택하실 건가요?

답:
- A안 : 전부 delete 후에 새로 추가한 것을 INSERT 하는 형태로 진행, 삭제도 똑같이 전체 삭제 후 재삽입 하는 형태로 감
- B안 : 해당 row 만 업데이트, 삭제 시에도 1건만 삭제

- 실무에서는 대부분 개수가 많은 컬렉션을 이용하게 될 것이기 때문에 @OneToMany 방식을 이용하는게 훨씬 효율적일 것 같습니다. 

---

### Q2. 임베디드 타입과 불변 객체

임베디드 타입(`@Embeddable`)은 여러 엔티티에서 공유하면 사이드 이펙트가 발생할 수 있다고 합니다.
이를 방지하기 위해 "불변 객체로 만들어야 한다"고 하는데,

- 불변 객체로 만들면 값을 변경하고 싶을 때는 어떻게 해야 할까요?
- 본인이 실무에서 Address 같은 임베디드 타입을 설계한다면 어떻게 하실건가요?

답)
- 새 객체를 만들어서 변경하는 식으로 합니다. 
- 코틀린의 상황이라면 val 객체로 만들어 불변성 강제 방식을 사용하게 하고 with, copy 같은 식으로 값을 변경할 수 있게 할 것 같습니다.  


---


## (Optional) 자유 토론 주제
9장을 읽으며 추가로 고민한 점이나 토론하고 싶은 주제가 있다면 자유롭게 작성해주세요.

- 값 타입 컬렉션을 사용하지 않는 편이 나을 것 같은데, 또 어떻게 보면 개수가 적으면 사용하는게 더 나을수도 있겠다 싶기도 하고, 몇개까지가 마지노선일지?